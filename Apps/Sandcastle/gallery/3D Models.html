<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <meta name="description" content="Create 3D models using glTF.">
    <meta name="cesium-sandcastle-labels" content="Tutorials,Showcases">
    <title>Cesium Demo</title>
    <script type="text/javascript" src="../Sandcastle-header.js"></script>
    <script type="text/javascript" src="../../../Build/CesiumUnminified/Cesium.js" nomodule></script>
    <script type="module" src="../load-cesium-es6.js"></script>
</head>
<body class="sandcastle-loading" data-sandcastle-bucket="bucket-requirejs.html">
<style>
    @import url(../templates/bucket.css);
</style>
<div id="cesiumContainer" class="fullSize"></div>
<div id="loadingOverlay"><h1>Loading...</h1></div>
<div id="toolbar"></div>
<script id="cesium_sandcastle_script">
function startup(Cesium) {
    'use strict';
//Sandcastle_Begin
var viewer = new Cesium.Viewer('cesiumContainer', {
    infoBox : false,
    selectionIndicator : false,
    shadows : true,
    shouldAnimate : true
});
viewer.scene.sun = null;
let scene = viewer.scene
scene.highDynamicRange = true;
var position = Cesium.Cartesian3.fromDegrees(-123.0744619, 44.0503706, 10);
var url = '../../SampleData/models/jiangxi.gltf';
// let url = '../../SampleData/models/BoomBox/scene.gltf'
viewer.trackedEntity = viewer.entities.add({
    name : url,
    position,
    model : {
        uri : url,
        color: new Cesium.Color(1., 1., 1., 1),
        // scale : 40.0
    }
});

var z = 0

// var blueBox = viewer.entities.add({
//     name : 'Blue box',
//     position:  Cesium.Cartesian3.fromDegrees(-123.0744619, 44.0503706, z),
//     box : {
//         dimensions : new Cesium.Cartesian3(10.0, 10.0, 10.0),
//         material : Cesium.Color.BLUE
//     }
// });
var clock = viewer.clock;
var lastUpdated = clock.currentTime;
clock.onTick.addEventListener(function() {
    var dt = Cesium.JulianDate.secondsDifference(clock.currentTime, lastUpdated);
    if (dt >= 1) {
        // Add a new sample position
        lastUpdated = clock.currentTime;
        // z++
        // blueBox.position = new Cesium.Cartesian3(200,200,200)
        // viewer.scene.lights[1].position = blueBox.position._value
    }
});

scene.lights = [
            {
                type: 0, //directional
                direction: new Cesium.Cartesian3(),
                color: new Cesium.Color(10.3,3,6)
            },
            {
                type: 1, //point
                // position: Cesium.Cartesian3.fromDegrees(-123.0744619, 44.0503706, z),
                position: new Cesium.Cartesian3(37.5145034790039, 79.035301208496094, -18.98169994354248),
                color: new Cesium.Color(10.3,3,6),
                constant: 1,
				linear: .09,
				quadratic: .032
            }
        ]


let handler = new Cesium.ScreenSpaceEventHandler(scene.canvas);
handler.setInputAction(function(movement) {
    var pickedObject = scene.pick(movement.position);
    if (scene.pickPositionSupported && Cesium.defined(pickedObject) && pickedObject.id === viewer.trackedEntity)
        var cartesian = viewer.scene.pickPosition(movement.position);
    console.log(cartesian)
}, Cesium.ScreenSpaceEventType.LEFT_CLICK);

//Sandcastle_End
    Sandcastle.finishedLoading();
}
if (typeof Cesium !== 'undefined') {
    window.startupCalled = true;
    startup(Cesium);
}
</script>
</body>
</html>
